<div>
  <div class="service">
    <h3>経歴書自動生成AI</h3>
    </br>
    <p>AI技術を用いて、日本語の経歴書を自動で生成。スピーディーに転職活動をサポートします。</p>
    <div style="display: flex; justify-content: center; align-items: center; flex: 1;">
      <%= link_to '経歴書を作成する', new_applicant_path, class: "header-link", style: "text-decoration: none;" %>
    </div>
  </div>

  <div class="row m-4">
    <div class="col-sm-6 mb-4">
      <div class="uploaded-file" style="margin-top: 20px; text-align: center;">
        <% if @user.resume.attached? %>
          <h3>アップロードされたファイル</h3>
          <% if @user.resume.content_type.start_with?('image/') %>
            <%= image_tag url_for(@user.resume), style: "max-width: 100%; height: auto;" %>
          <% elsif @user.resume.content_type == 'application/pdf' %>
            <%= tag.iframe src: url_for(@user.resume), style: "width: 100%; height: 100vh;" %>
          <% else %>
            <p>このファイルは表示できません。<%= link_to 'こちらからダウンロード', url_for(@user.resume) %>してください。</p>
          <% end %>
        <% end %>
      </div>
      <h3>改善点の提案</h3>
      <% if @improvement_suggestions %>
        <div class="suggestions" style="margin-top: 20px;">
          <div class="advice-box">
            <%= simple_format(@improvement_suggestions) %>
          </div>
        </div>
      <% else %>
        <p>なし</p>
      <% end %>
    </div>
    <div class="col-sm-6 mb-4">
      <div class="form-modern" style="background: #fff; padding: 40px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
        <h2 style="text-align: center; margin: 20px; color: #333;">既存の経歴書をアップロード</h2>
        <%= form_with model: @user, url: user_path(@user), local: true, multipart: true do |form| %>
          <div style="margin-bottom: 20px;">
            <%= form.file_field :resume, style: "width: 100%; padding: 12px 20px; font-size: 16px; border: 1px solid #ddd; border-radius: 5px; background: #f9f9f9; outline: none; transition: border-color 0.3s;" %>
          </div>
          <div style="text-align: center;">
            <%= form.submit "アップロード", style: "padding: 12px 30px; font-size: 16px; background-color: #4285F4; color: white; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s;" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <h1><%= @user.username %>のプロフィール</h1>
  
  <div>
    <% if @user.avatar.attached? %>
      <%= image_tag url_for(@user.avatar), style: "max-width: 10%; height: auto;" %>
    <% else %>
      <p>アバター画像がありません。</p>
    <% end %>
  </div>

  <p>メール: <%= @user.email %></p>
  <p>ユーザー名: <%= @user.username %></p>
  <p>役割: <%= @user.role %></p>

  <% if @user.rolable_type == 'Applicant' %>
    <h2>応募者情報</h2>
    <p>名前: <%= @user.rolable.name %></p>
    <p>生年月日: <%= @user.rolable.birthday %></p>
    <p>年齢: <%= @user.rolable.age %></p>
    <p>国籍: <%= @user.rolable.nationality %></p>
    <p>電話番号: <%= @user.rolable.phone_number %></p>
    <p>自己紹介: <%= @user.rolable.self_introduction %></p>
    <p>希望給与: <%= @user.rolable.desired_salary %></p>
  <% end %>
</div>

<style>
.advice-box {
  background-color: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 5px;
  padding: 15px;
  margin-top: 10px;
}

.advice-box ul {
  padding-left: 20px;
}

.advice-box li {
  margin-bottom: 10px;
}
</style>
