<div class="container container-sm container-md container-lg">
  <div class="row m-4">
    <div class="col-sm-4 mb-4">
      <div>
        <% if @user.avatar.attached? %>
          <%= image_tag url_for(@user.avatar), style: "max-width: 10%; height: auto;" %>
        <% else %>
          <img src="https://mdbcdn.b-cdn.net/img/new/avatars/2.webp" class="rounded-circle" style="width: 150px;" alt="Avatar" />
        <% end %>
      </div>
      <p>メール: <%= @user.email %></p>
      <p>ユーザー名: <%= @user.username %></p>
      <% if Rails.env.development? %>
        <p><strong>役割:</strong> <%= @user.role %></p>
      <% end %>

      <% if @user.rolable_type == 'Applicant' %>
        <% if @user.rolable.birthday.present? %>
          <p>生年月日: <%= @user.rolable.birthday %></p>
        <% end %>
        
        <% if @user.rolable.age.present? %>
          <p>年齢: <%= @user.rolable.age %></p>
        <% end %>
        
        <% if @user.rolable.nationality.present? %>
          <p>国籍: <%= @user.rolable.nationality %></p>
        <% end %>
        
        <% if @user.rolable.phone_number.present? %>
          <p>電話番号: <%= @user.rolable.phone_number %></p>
        <% end %>
        
        <% if @user.rolable.self_introduction.present? %>
          <p>自己紹介: <%= @user.rolable.self_introduction %></p>
        <% end %>
        
        <% if @user.rolable.desired_salary.present? %>
          <p>希望給与: <%= @user.rolable.desired_salary %></p>
        <% end %>

      <div class="uploaded-file" style="margin-top: 20px; text-align: center;">
        <% if @user.rolable&.resume.attached? %>
          <h3>アップロードされたファイル</h3>
          <% if @user.resume.content_type.start_with?('image/') %>
            <%= image_tag url_for(@user.resume), style: "max-width: 100%; height: auto;" %>
          <% elsif @user.resume.content_type == 'application/pdf' %>
            <%= tag.iframe src: url_for(@user.resume), style: "width: 100%; height: 100vh;" %>
          <% else %>
            <p>このファイルは表示できません。<%= link_to 'こちらからダウンロード', url_for(@user.resume) %>してください。</p>
          <% end %>
        <% end %>
      </div>
      <% end %>
    </div>

    <div class="col-sm-8 mb-8">
      <div class="form-modern" style="background: #fff; padding: 40px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
        <h2 style="text-align: center; margin: 20px; color: #333;">既存の経歴書をアップロード</h2>
        <%= form_with model: @user, url: user_path(@user), local: true, multipart: true do |form| %>
          <div style="margin-bottom: 20px;">
            <%= form.file_field :resume, style: "width: 100%; padding: 12px 20px; font-size: 16px; border: 1px solid #ddd; border-radius: 5px; background: #f9f9f9; outline: none; transition: border-color 0.3s;" %>
          </div>
          <div style="text-align: center;">
            <%= form.submit "アップロード", style: "padding: 12px 30px; font-size: 16px; background-color: #4285F4; color: white; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.3s;" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
    <div class="row m-4">
        <h3>改善点の提案</h3>
      <% if @improvement_suggestions %>
        <div class="suggestions" style="margin-top: 20px;">
          <div class="advice-box">
            <%= simple_format(@improvement_suggestions) %>
          </div>
        </div>
      <% else %>
        <p>なし</p>
      <% end %>
    </div>
</div>

<style>
.advice-box {
  background-color: #f8f9fa;
  border: 1px solid #e9ecef;
  border-radius: 5px;
  padding: 15px;
  margin-top: 10px;
}

.advice-box ul {
  padding-left: 20px;
}

.advice-box li {
  margin-bottom: 10px;
}
</style>
